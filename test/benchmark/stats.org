* Performance metrics

** View

*** 8x Intel(R) Core(TM) i7-6770HQ CPU @ 2.60GHz, 16Gb, SSD

sambamba 0.6.7

This version was built with:
    LDC 1.1.1
    using DMD v2.071.2
    using LLVM 3.9.1
    bootstrapped with LDC - the LLVM D compiler (1.1.1)

time ./build/sambamba view /gnu/data/HG00100.chrom20.ILLUMINA.bwa.GBR.low_coverage.20130415.bam.orig > /dev/null

real    0m3.150s
user    0m24.668s
sys     0m0.320s

sambamba 0.6.7

This version was built with:
    LDC 1.7.0
    using DMD v2.077.1
    using LLVM 5.0.1
    bootstrapped with LDC - the LLVM D compiler (1.7.0)


real    0m2.869s
user    0m22.344s
sys     0m0.344s


** Sort

*** 56x Intel(R) Xeon(R) CPU E5-2683 v3 @ 2.00GHz, 256Gb

sambamba 0.6.6

This version was built with:
    LDC 0.17.1
    using DMD v2.068.2
    using LLVM 3.8.0
    bootstrapped with version not available

time ./sambamba_v0.6.6 sort -m 20615843020 -N -o /dev/null ENCFF696RLQ.bam -p
real    10m0.932s
user    151m39.172s
sys     3m7.596s

sambamba 0.6.6

This version was built with:
    LDC 1.1.1
    using DMD v2.071.2
    using LLVM 3.9.1
    bootstrapped with LDC - the LLVM D compiler (1.1.1)

time ./sambamba sort -m 20615843020 -N -o /dev/null ENCFF696RLQ.bam -p

real    9m22.501s
user    98m24.748s
sys     2m51.996s

Note, updating compiler shows a speed gain for 0.6.6.

sambamba 0.6.7

This version was built with:
    LDC 1.7.0
    using DMD v2.077.1
    using LLVM 5.0.1
    bootstrapped with LDC - the LLVM D compiler (1.7.0)

time ./sambamba sort -m 20615843020 -N -o /dev/null ENCFF696RLQ.bam -p

real    18m15.809s
user    158m30.148s
sys     3m15.932s

Ouch! A regression.

sambamba 0.6.7

This version was built with:
    LDC 1.1.1
    using DMD v2.071.2
    using LLVM 3.9.1
    bootstrapped with LDC - the LLVM D compiler (1.1.1)
    ldc2 -wi -I. -IBioD -IundeaD/src -g -O3 -release -enable-inlining -boundscheck=off

penguin2:~$ time ./sambamba sort -m 20615843020 -N -o /dev/null ENCFF696RLQ.bam -p
real    18m40.223s
user    159m34.292s
sys     3m19.300s

So, the same build is 2x slower than the previous version.

This version was built with:
    LDC 1.1.1
    using DMD v2.071.2
    using LLVM 3.9.1
    bootstrapped with LDC - the LLVM D compiler (1.1.1)
    Using ldmd2 @sambamba-ldmd-release.rsp
    "-g" "-O2" "-c" "-m64" "-release" "-IBioD/" "-IundeaD/src/" "-ofbuild/sambamba.o" "-odbuild" "-I."
    gcc -Wl,--gc-sections -o build/sambamba build/sambamba.o -Lhtslib -Llz4/lib -Wl,-Bstatic -lhts -llz4 -Wl,-Bdynamic /home/wrk/opt/ldc2-1.1.1-linux-x86_64/lib/libphobos2-ldc.a /home/wrk/opt/ldc2-1.1.1-linux-x86_64/lib/libdruntime-ldc.a -lrt -lpthread -lm


date && time ./sambamba sort -m 20615843020 -N -o /dev/null ENCFF696RLQ.bam -p

real    9m9.465s
user    97m56.204s
sys     2m50.512s

Updated the makefile to build with -singleobj. Now LLVM kicks in

sambamba 0.6.7

This version was built with:
    LDC 1.7.0
    using DMD v2.077.1
    using LLVM 5.0.1
    bootstrapped with LDC - the LLVM D compiler (1.7.0)

real    8m1.978s
user    89m13.936s
sys     2m47.392s
